\n-- Workflow Automation Logs Table\n-- Tracks all automated workflow executions, triggers, and results\n\nCREATE TABLE IF NOT EXISTS workflow_automation_logs (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    workflow_id VARCHAR(255) NOT NULL,\n    workflow_name VARCHAR(255) NOT NULL,\n    trigger_type VARCHAR(100) NOT NULL, -- 'calendar_event', 'deadline_alert', 'email_received', 'manual', 'scheduled'\n    trigger_data TEXT, -- JSON data about what triggered the workflow\n    \n    -- Execution details\n    status VARCHAR(50) NOT NULL DEFAULT 'pending', -- 'pending', 'running', 'completed', 'failed', 'cancelled'\n    started_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    completed_at DATETIME,\n    execution_time_ms INTEGER,\n    \n    -- Results and actions\n    actions_executed TEXT, -- JSON array of actions that were executed\n    success_count INTEGER DEFAULT 0,\n    failure_count INTEGER DEFAULT 0,\n    \n    -- Error handling\n    error_message TEXT,\n    error_details TEXT, -- JSON with detailed error information\n    retry_count INTEGER DEFAULT 0,\n    max_retries INTEGER DEFAULT 3,\n    \n    -- Context and metadata\n    user_id VARCHAR(255),\n    entity_type VARCHAR(100), -- 'task', 'case', 'deadline', 'calendar_event'\n    entity_id VARCHAR(255),\n    context_data TEXT, -- JSON with additional context\n    \n    -- AI insights\n    ai_confidence_score DECIMAL(5,4), -- AI confidence in the automation decision\n    ai_reasoning TEXT,\n    \n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Real-Time Metrics Storage Table\n-- Stores real-time performance and intelligence metrics\n\nCREATE TABLE IF NOT EXISTS real_time_metrics (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    metric_type VARCHAR(100) NOT NULL, -- 'productivity', 'workload', 'deadline_risk', 'case_velocity', 'efficiency'\n    metric_name VARCHAR(255) NOT NULL,\n    metric_value DECIMAL(10,4) NOT NULL,\n    metric_unit VARCHAR(50), -- 'percentage', 'hours', 'count', 'score'\n    \n    -- Time series data\n    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,\n    time_bucket VARCHAR(50), -- 'hourly', 'daily', 'weekly', 'monthly'\n    \n    -- Context and filtering\n    user_id VARCHAR(255),\n    entity_type VARCHAR(100), -- 'task', 'case', 'user', 'system'\n    entity_id VARCHAR(255),\n    category VARCHAR(100),\n    subcategory VARCHAR(100),\n    \n    -- Additional data\n    metadata TEXT, -- JSON with additional metric details\n    calculation_method VARCHAR(255),\n    data_source VARCHAR(100), -- 'ai_analysis', 'user_action', 'system_calculation', 'external_api'\n    \n    -- Quality indicators\n    confidence_level DECIMAL(5,4),\n    is_anomaly BOOLEAN DEFAULT FALSE,\n    trend_direction VARCHAR(20), -- 'increasing', 'decreasing', 'stable', 'volatile'\n    \n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Mobile Sync Status Table\n-- Tracks mobile synchronization status and offline data management\n\nCREATE TABLE IF NOT EXISTS mobile_sync_status (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id VARCHAR(255) NOT NULL,\n    device_id VARCHAR(255) NOT NULL,\n    device_type VARCHAR(50), -- 'ios', 'android', 'web'\n    \n    -- Sync status\n    last_sync_at DATETIME,\n    sync_status VARCHAR(50) DEFAULT 'pending', -- 'pending', 'syncing', 'completed', 'failed'\n    sync_direction VARCHAR(20), -- 'up', 'down', 'bidirectional'\n    \n    -- Data tracking\n    entities_to_sync TEXT, -- JSON array of entity types and IDs that need syncing\n    synced_entities TEXT, -- JSON array of successfully synced entities\n    failed_entities TEXT, -- JSON array of entities that failed to sync\n    \n    -- Performance metrics\n    sync_duration_ms INTEGER,\n    data_size_bytes INTEGER,\n    bandwidth_used_kb INTEGER,\n    \n    -- Conflict resolution\n    conflicts_detected INTEGER DEFAULT 0,\n    conflicts_resolved INTEGER DEFAULT 0,\n    conflict_resolution_strategy VARCHAR(100), -- 'server_wins', 'client_wins', 'merge', 'manual'\n    \n    -- Error handling\n    error_message TEXT,\n    error_code VARCHAR(50),\n    retry_count INTEGER DEFAULT 0,\n    \n    -- Network conditions\n    network_type VARCHAR(50), -- 'wifi', 'cellular', 'offline'\n    network_quality VARCHAR(50), -- 'excellent', 'good', 'poor', 'very_poor'\n    \n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Background Job Queue Table\n-- Manages background processing tasks\n\nCREATE TABLE IF NOT EXISTS background_jobs (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    job_type VARCHAR(100) NOT NULL, -- 'ai_analysis', 'email_parsing', 'deadline_calculation', 'sync', 'automation'\n    job_name VARCHAR(255) NOT NULL,\n    priority INTEGER DEFAULT 5, -- 1 (highest) to 10 (lowest)\n    \n    -- Job data\n    payload TEXT, -- JSON data for the job\n    context TEXT, -- JSON context information\n    \n    -- Scheduling\n    scheduled_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    started_at DATETIME,\n    completed_at DATETIME,\n    expires_at DATETIME,\n    \n    -- Status tracking\n    status VARCHAR(50) DEFAULT 'queued', -- 'queued', 'running', 'completed', 'failed', 'cancelled', 'expired'\n    attempts INTEGER DEFAULT 0,\n    max_attempts INTEGER DEFAULT 3,\n    \n    -- Progress tracking\n    progress_percentage INTEGER DEFAULT 0,\n    current_step VARCHAR(255),\n    total_steps INTEGER,\n    \n    -- Results and errors\n    result TEXT, -- JSON result data\n    error_message TEXT,\n    error_details TEXT,\n    \n    -- Dependencies\n    depends_on_job_id INTEGER, -- ID of job this depends on\n    blocks_job_ids TEXT, -- JSON array of job IDs this blocks\n    \n    -- Performance\n    estimated_duration_ms INTEGER,\n    actual_duration_ms INTEGER,\n    \n    -- Metadata\n    user_id VARCHAR(255),\n    created_by VARCHAR(255), -- 'system', 'user', 'automation'\n    \n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    \n    FOREIGN KEY (depends_on_job_id) REFERENCES background_jobs(id)\n);\n\n-- Push Notification Queue Table\n-- Manages mobile push notifications\n\nCREATE TABLE IF NOT EXISTS push_notifications (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id VARCHAR(255) NOT NULL,\n    device_tokens TEXT, -- JSON array of device tokens to send to\n    \n    -- Notification content\n    title VARCHAR(255) NOT NULL,\n    body TEXT NOT NULL,\n    icon VARCHAR(255),\n    badge_count INTEGER,\n    sound VARCHAR(100),\n    \n    -- Delivery settings\n    priority VARCHAR(20) DEFAULT 'normal', -- 'low', 'normal', 'high', 'critical'\n    category VARCHAR(100), -- 'deadline', 'task', 'case', 'emergency', 'system'\n    \n    -- Scheduling\n    scheduled_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    sent_at DATETIME,\n    delivered_at DATETIME,\n    opened_at DATETIME,\n    \n    -- Status tracking\n    status VARCHAR(50) DEFAULT 'queued', -- 'queued', 'sent', 'delivered', 'failed', 'cancelled'\n    delivery_attempts INTEGER DEFAULT 0,\n    max_attempts INTEGER DEFAULT 3,\n    \n    -- Content data\n    action_url VARCHAR(500),\n    action_data TEXT, -- JSON data for the action\n    custom_data TEXT, -- JSON custom notification data\n    \n    -- Analytics\n    click_through_rate DECIMAL(5,4),\n    engagement_score DECIMAL(5,4),\n    \n    -- Error handling\n    error_message TEXT,\n    error_code VARCHAR(50),\n    \n    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,\n    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Performance Monitoring Table\n-- Tracks system performance metrics\n\nCREATE TABLE IF NOT EXISTS performance_metrics (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    metric_type VARCHAR(100) NOT NULL, -- 'api_response_time', 'database_query', 'ai_processing', 'ui_render'\n    component VARCHAR(255) NOT NULL,\n    operation VARCHAR(255),\n    \n    -- Performance data\n    duration_ms INTEGER NOT NULL,\n    memory_usage_mb DECIMAL(10,2),\n    cpu_usage_percentage DECIMAL(5,2),\n    \n    -- Context\n    user_id VARCHAR(255),\n    session_id VARCHAR(255),\n    request_id VARCHAR(255),\n    \n    -- Additional metrics\n    success BOOLEAN DEFAULT TRUE,\n    error_message TEXT,\n    metadata TEXT, -- JSON with additional performance data\n    \n    -- Environment\n    environment VARCHAR(50), -- 'development', 'staging', 'production'\n    version VARCHAR(50),\n    device_type VARCHAR(50),\n    browser_type VARCHAR(100),\n    \n    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP\n);\n\n-- Create indexes for better performance\nCREATE INDEX IF NOT EXISTS idx_workflow_logs_status ON workflow_automation_logs(status);\nCREATE INDEX IF NOT EXISTS idx_workflow_logs_workflow_id ON workflow_automation_logs(workflow_id);\nCREATE INDEX IF NOT EXISTS idx_workflow_logs_created_at ON workflow_automation_logs(created_at);\nCREATE INDEX IF NOT EXISTS idx_workflow_logs_user_id ON workflow_automation_logs(user_id);\n\nCREATE INDEX IF NOT EXISTS idx_real_time_metrics_type ON real_time_metrics(metric_type);\nCREATE INDEX IF NOT EXISTS idx_real_time_metrics_timestamp ON real_time_metrics(timestamp);\nCREATE INDEX IF NOT EXISTS idx_real_time_metrics_user_id ON real_time_metrics(user_id);\nCREATE INDEX IF NOT EXISTS idx_real_time_metrics_entity ON real_time_metrics(entity_type, entity_id);\n\nCREATE INDEX IF NOT EXISTS idx_mobile_sync_user_device ON mobile_sync_status(user_id, device_id);\nCREATE INDEX IF NOT EXISTS idx_mobile_sync_sta
